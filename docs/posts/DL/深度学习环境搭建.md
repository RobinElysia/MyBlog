---

title: 深度学习环境搭建
description: 深度学习环境搭建
date: 2025-11-06
timeline: true
head:
  - - meta
    - name: keywords
      content: 深度学习环境搭建
  - - meta
    - name: description
      content: 深度学习环境搭建
  - - meta
    - name: author
      content: RobinElysia
category:
  - RobinElysia
tag:
  - Deep Learning

---

## 前言
准备工作：
1. 虚拟机：WSL Ubuntu 20.04 以上版本（不含20.04，低版本系统处理方案我会放在文中）
2. Python：3.10
3. [virtualenv：任意版本](https://pypi.org/project/virtualenv/#files)
4. [CUDA：11.8](https://developer.nvidia.com/cuda-11-8-0-download-archive?target_os=Linux&target_arch=x86_64&Distribution=WSL-Ubuntu&target_version=2.0)
5. [cuDNN：CUDA 11.X → cuDNN 8.9.7](https://developer.nvidia.com/rdp/cudnn-archive)
6. [PyTorch：2.0.1](https://pypi.org/project/torch/2.0.1/#files)
7. [Tensorflow：2.12.1](https://pypi.org/project/tensorflow/2.12.1/#files)

注意：Python、CUDA、cuDNN、PyTorch、Tensorflow这五者拥有较强的依赖关系，其中 CUDA and cuDNN 是强依赖关系，CUDA 与 Pytorch、Tensorflow 是强依赖关系。因为我这里使用的是离线安装，很大程度上需要自行处理依赖关系，所以特此强调。对于直接 pip install XXX 的在线用户，大概率无需考虑 pytorch 和 tensorflow 的版本问题。

### 虚拟环境与 Python 安装

这里采用 WSL2 作为本地开发环境支持，为什么不选 VM 和 其他的虚拟化技术，一是 VM 有点大材小用的感觉，虚拟化环境配发 4 核心或许不太够用；为什么不用 Docker 虚拟环境，一方面是出现的各种硬件虚拟化问题，一方面是精简虚拟化环境可能导致各种意料之外的问题。所以我们采用折中方案， WSL2 虚拟化。

对于 WSL2 而言，我建议使用 Ubuntu 22 以上的版本，Python 环境无需有过多的担忧，20 及以下版本 apt 无 py3.8 以上版本，需要手动编译高版本 py，我会给出详细的高低版本教程。

#### 高版本系统

```bash
# 更新
sudo apt upgrade
sudo apt update

# 查看是否存在高版本 py
sudo apt list python3
# 查看是否存在 3.9 以上版本

# 选择存在的高版本进行安装
sudo apt install python3.9/python3.10/...

# 验证
python3 --version

# 出现正常回显代表成功
Python 3.10.17
```

#### 低版本系统

低版本较为麻烦，需要去 python 官网或者ustc源直接下载高版本的压缩包，解压缩编译

这里我们选择 ustc源 进行下载，链接如下：
https://mirrors.ustc.edu.cn/python/3.10.8/Python-3.10.8.tar.xz

步骤如下：

```bash

# 进入到opt中
cd /opt
# 下载安装包
wget https://mirrors.ustc.edu.cn/python/3.10.8/Python-3.10.8.tar.xz
# 解压缩
tar -xvf Python-3.10.8.tar.xz
# 进入文件夹
cd Python-3.10.8

# 更新，安装gcc/g++/make
sudo apt update
sudo apt install -y build-essential

# 安装 zlib1g 依赖
sudo apt install -y zlib1g-dev libssl-dev libbz2-dev libreadline-dev \
  libsqlite3-dev libncursesw5-dev xz-utils tk-dev libffi-dev liblzma-dev

# 验证
gcc --version   # 应能看到版本号

# 在 Python-3.10.8 中进行编译
sudo ./configure --prefix=/usr/local/python3.11 \
                 --enable-optimizations \
                 --with-ensurepip=install
                 

sudo make -j$(nproc)
sudo make install

# 编译完成就成功了

```

比赛的时候，这一步 py 环境的搭建是没有的，毕竟连最基本的环境都没有，还打什么比赛？？？

### CUDA 与 cuDNN

#### CUDA

```bash

# 在普通用户下，检测最高支持的 CUDA 版本
nvidia-smi # 这一步比赛忽略

# 直接安装比最高支持版本低的版本
cd /opt && wget https://developer.download.nvidia.com/compute/cuda/11.8.0/local_installers/cuda_11.8.0_520.61.05_linux.run # 这一步可忽略，因为比赛方会提供文件

# 运行
sudo su cuda_11.8.0_520.61.05_linux.run
# 时间会很长，因为文件很大
后边就是 accept 即可

# 环境配置
vim ~/.bashrc
export PATH=/usr/local/cuda-11.8/bin=${PATH}
export LD_LIBRARY_PATH=/usr/local/cuda-11.8/lib64=${LD_LIBRARY_PATH}
export CUDA_HOME=/usr/local/suda-11.8
# 保存退出
# 刷新
source ~/.bashrc

# 验证
nvcc -V
# 回显
nvcc: NVIDIA (R) Cuda compiler driver
Copyright (c) 2005-2022 NVIDIA Corporation
Built on Wed_Sep_21_10:33:58_PDT_2022
Cuda compilation tools, release 11.8, V11.8.89
Build cuda_11.8.r11.8/compiler.31833905_0

```

#### cuDNN

```bash
# 下载
wget https://developer.nvidia.com/downloads/compute/cudnn/secure/8.9.7/local_installers/12.x/cudnn-linux-x86_64-8.9.7.29_cuda12-archive.tar.xz/ # 比赛忽略这一步

# 解压缩
tar -xvf cudnn-linux-x86_64-8.9.7.29_cuda11-archive.tar.xz
# 进入解压后的文件夹
cd cudnn-linux-x86_64-8.9.7.29_cuda11-archive
# 移动文件到原来 CUDA 安装的文件夹下
sudo cp include/* /usr/local/cuda-11.8/include
sudo cp lib/libcudnn* /usr/local/cuda-11.8/lib64
# 你需要确认以下文件夹名对不对

# 给予权限
sudo chmod a+r /usr/local/cuda-11.8/include/cudnn*.h /usr/local/cuda/lib64/libcudnn*

# 安装完成
```

### 安装 Virtualenv、Pytorch、Tensorflow

#### Virtualenv

```bash

# 进入 opt
cd /opt
# 下载 whl
wget https://files.pythonhosted.org/packages/79/0c/c05523fa3181fdf0c9c52a6ba91a23fbf3246cc095f26f6516f9c60e6771/virtualenv-20.35.4-py3-none-any.whl # 比赛忽略

# 安装
pip install /opt/virtualenv-20.35.4-py3-none-any.whl

```

以下是直接在全局进行安装 Pytorch Tensorflow
#### Pytorch

```bash

# 在 opt 下
wget https://files.pythonhosted.org/packages/21/33/4925decd863ce88ed9190a4bd872b01c146243ee68db08c72923984fe335/torch-2.0.1-cp310-cp310-manylinux2014_aarch64.whl

# 安装
pip install /opt/torch-2.0.1-cp310-cp310-manylinux2014_aarch64.whl

```

#### Tensorflow

```bash

# 在 opt 下
wget https://files.pythonhosted.org/packages/21/33/4925decd863ce88ed9190a4bd872b01c146243ee68db08c72923984fe335/torch-2.0.1-cp310-cp310-manylinux2014_aarch64.whl

# 安装
pip install /opt/torch-2.0.1-cp310-cp310-manylinux2014_aarch64.whl

```

或者使用Virtualenv新建虚拟环境进行安装：
#### Virtualenv 虚拟环境下安装环境

```bash

# 假如在 /home/user/test 下
virtualenv -p python3.10 ProjectName
# 新建虚拟环境 ProjectName
# 激活虚拟环境
source /home/user/test/ProjectName/bin/activate

# 安装依赖
pip install /opt/torch-2.0.1-cp310-cp310-manylinux2014_aarch64.whl && pip install /opt/torch-2.0.1-cp310-cp310-manylinux2014_aarch64.whl

# 验证 CUDA、cuDNN、Pytorch、Tensorflow是否安装成功
# Pytorch
python -c "import torch; print(torch.__version__); print(torch.version.cuda); print(torch.backends.cudnn.version())"
# Tensorflow
python -c "import tensorflow as tf; print(tf.__version__); print(tf.config.list_physical_devices('GPU'))"
```